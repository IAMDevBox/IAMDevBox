<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Building a Secure PKCE Flow with Kotlin and Spring Boot | IAMDevBox</title>
<meta name="keywords" content="OAuth 2.0, PKCE, Kotlin, Spring Boot, Secure Authentication, Authorization Code Flow">
<meta name="author" content="IAMDevBox">
<link rel="canonical" href="https://www.iamdevbox.com/posts/building-a-secure-pkce-flow-with-kotlin-and-spring-boot/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.f49d66caae9ea0fd43f21f29e71a8d3e284517ed770f2aa86fa012953ad3c9ef.css" integrity="sha256-9J1myq6eoP1D8h8p5xqNPihFF&#43;13Dyqob6ASlTrTye8=" rel="preload stylesheet" as="style">


<link rel="icon" href="https://www.iamdevbox.com/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://www.iamdevbox.com/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://www.iamdevbox.com/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://www.iamdevbox.com/apple-touch-icon.png">
<link rel="mask-icon" href="https://www.iamdevbox.com/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://www.iamdevbox.com/posts/building-a-secure-pkce-flow-with-kotlin-and-spring-boot/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>

<link rel="stylesheet" href="/css/custom.min.f87e4df74f4f070695effe5d49ae4914eb9228356e4300800036f51859f72d47.css" media="print" onload="this.media='all'">
<noscript><link rel="stylesheet" href="/css/custom.min.f87e4df74f4f070695effe5d49ae4914eb9228356e4300800036f51859f72d47.css"></noscript>

<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<meta property="og:url" content="https://www.iamdevbox.com/posts/building-a-secure-pkce-flow-with-kotlin-and-spring-boot/">
  <meta property="og:site_name" content="IAMDevBox">
  <meta property="og:title" content="Building a Secure PKCE Flow with Kotlin and Spring Boot">
  <meta property="og:description" content="Proof Key for Code Exchange (PKCE) has become a standard security enhancement to the OAuth 2.0 Authorization Code Flow—especially in public clients like mobile...">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-06-04T21:09:19+00:00">
    <meta property="article:modified_time" content="2025-06-06T19:33:33-04:00">
    <meta property="article:tag" content="OAuth 2.0">
    <meta property="article:tag" content="PKCE">
    <meta property="article:tag" content="Kotlin">
    <meta property="article:tag" content="Spring Boot">
    <meta property="article:tag" content="Secure Authentication">
    <meta property="article:tag" content="Authorization Code Flow">
      <meta property="og:image" content="https://www.iamdevbox.com/static/IAMDevBox.com.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://www.iamdevbox.com/static/IAMDevBox.com.png">
<meta name="twitter:title" content="Building a Secure PKCE Flow with Kotlin and Spring Boot">
<meta name="twitter:description" content="Proof Key for Code Exchange (PKCE) has become a standard security enhancement to the OAuth 2.0 Authorization Code Flow—especially in public clients like mobile...">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "All posts",
      "item": "https://www.iamdevbox.com/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Building a Secure PKCE Flow with Kotlin and Spring Boot",
      "item": "https://www.iamdevbox.com/posts/building-a-secure-pkce-flow-with-kotlin-and-spring-boot/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Building a Secure PKCE Flow with Kotlin and Spring Boot",
  "name": "Building a Secure PKCE Flow with Kotlin and Spring Boot",
  "description": "Proof Key for Code Exchange (PKCE) has become a standard security enhancement to the OAuth 2.0 Authorization Code Flow—especially in public clients like mobile...",
  "keywords": [
    "OAuth 2.0", "PKCE", "Kotlin", "Spring Boot", "Secure Authentication", "Authorization Code Flow"
  ],
  "articleBody": "Proof Key for Code Exchange (PKCE) has become a standard security enhancement to the OAuth 2.0 Authorization Code Flow—especially in public clients like mobile and single-page applications. But PKCE isn’t just for frontend apps. When combined with a stateless backend built with Kotlin and Spring Boot, it strengthens your security posture, particularly when you’re avoiding client secrets.\nThis guide walks you through how to implement a secure PKCE flow using Kotlin and Spring Boot, including endpoint structure, code challenge generation, and token exchange.\nWhy Use PKCE with Spring Boot? PKCE was designed to protect public clients from authorization code interception attacks. But it also benefits backend applications that:\nDon’t want to manage confidential client secrets. Support both browser and native app clients. Need flexible OAuth 2.0 integrations with high security. While Spring Security supports OAuth 2.0 out of the box, PKCE is not always enabled by default in backend flows, and it requires custom configuration.\nPKCE Flow Recap The PKCE-enhanced flow works as follows:\nClient generates a code_verifier and a hashed code_challenge. It starts the OAuth 2.0 authorization request with the code_challenge. The user authenticates and the authorization server returns a code. The client exchanges the code for a token using the code_verifier. +--------+ +---------------+ | |--(A)- Authorization Request ------\u003e| | | | code_challenge (+ method) | | | | | Authorization | | Client |\u003c-(B)---- Authorization Code -------| Server | | | | | | |--(C)-- Token Request --------------\u003e| | | | code_verifier | | | |\u003c-(D)----- Access Token -------------| | +--------+ +---------------+ Step 1: Generate Code Verifier and Code Challenge You can generate the code verifier and challenge in Kotlin like this:\n// Kotlin snippet to generate code_verifier and code_challenge val secureRandom = SecureRandom() val codeVerifier = Base64.getUrlEncoder().withoutPadding().encodeToString( ByteArray(32).apply { secureRandom.nextBytes(this) } ) val digest = MessageDigest.getInstance(\"SHA-256\") val hashed = digest.digest(codeVerifier.toByteArray(StandardCharsets.US_ASCII)) val codeChallenge = Base64.getUrlEncoder().withoutPadding().encodeToString(hashed) println(\"Code Verifier: $codeVerifier\") println(\"Code Challenge: $codeChallenge\") Use the code_challenge in your authorization URL.\nStep 2: Build Authorization URL with PKCE // Kotlin snippet to build authorization URL val authorizationUrl = UriComponentsBuilder .fromUriString(\"https://your-oauth-server.com/oauth2/authorize\") .queryParam(\"response_type\", \"code\") .queryParam(\"client_id\", \"your-client-id\") .queryParam(\"redirect_uri\", \"http://localhost:8080/callback\") .queryParam(\"scope\", \"openid profile email\") .queryParam(\"code_challenge\", codeChallenge) .queryParam(\"code_challenge_method\", \"S256\") .build() .toUriString() This URL redirects the user to the OAuth authorization server, where they will login and authorize the app.\nStep 3: Exchange Authorization Code for Token Once you receive the authorization code, exchange it for tokens:\n// Spring WebClient example with PKCE token request val response = webClient.post() .uri(\"https://your-oauth-server.com/oauth2/token\") .body(BodyInserters.fromFormData(\"grant_type\", \"authorization_code\") .with(\"client_id\", \"your-client-id\") .with(\"redirect_uri\", \"http://localhost:8080/callback\") .with(\"code\", receivedCode) .with(\"code_verifier\", codeVerifier)) .retrieve() .bodyToMono(TokenResponse::class.java) .block() Define TokenResponse as a data class for mapping token results.\nReal-World Considerations Rotate code_verifier per request; never reuse. Use HTTPS for all token and authorization exchanges. PKCE flow complements rather than replaces your need for secure storage (especially refresh tokens). Use with ForgeRock or Identity Providers ForgeRock Identity Cloud supports PKCE natively. You can easily enable it in your client configuration. 👉 Related: Understanding the Authorization Code Flow with PKCE in OAuth 2.0\n👉 Related: Building Complete OIDC Login Flow URLs in ForgeRock Identity Cloud\nConclusion Using PKCE with Kotlin and Spring Boot isn’t just about mobile support—it’s a general OAuth 2.0 best practice. It protects your applications from malicious code interception while maintaining high developer agility.\nWhether you’re working on a microservice backend, BFF layer, or hybrid app, PKCE is a lightweight security upgrade worth adopting.\n🔍 What’s Next?\nCan you combine PKCE with Refresh Token Rotation securely? How would you handle PKCE flow in a multi-tenant SaaS app? Should confidential clients also implement PKCE? Let’s explore more in the next post.\n",
  "wordCount" : "589",
  "inLanguage": "en",
  "image": "https://www.iamdevbox.com/static/IAMDevBox.com.png","datePublished": "2025-06-04T21:09:19Z",
  "dateModified": "2025-06-06T19:33:33-04:00",
  "author":{
    "@type": "Person",
    "name": "IAMDevBox"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.iamdevbox.com/posts/building-a-secure-pkce-flow-with-kotlin-and-spring-boot/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "IAMDevBox",
    "logo": {
      "@type": "ImageObject",
      "url": "https://www.iamdevbox.com/favicon.ico"
    }
  }
}
</script><meta name="description" content="Proof Key for Code Exchange (PKCE) has become a standard security enhancement to the OAuth 2.0 Authorization Code Flow—especially in public clients like mobile...">
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@graph": [
          {
            "@type": "Article",
            "mainEntityOfPage": {
              "@type": "WebPage",
              "@id": "https:\/\/www.iamdevbox.com\/posts\/devops-is-not-just-tools--its-a-cultural-transformation\/"
            },
            "headline": "\"DevOps Is Not Just Tools — It’s a Cultural Transformation\"",
            "author": {
              "@type": "Person",
              "name": "IAMDevBox"
            },
            "publisher": {
              "@type": "Organization",
              "name": "IAMDevBox",
              "logo": {
                "@type": "ImageObject",
                "url": "\"https://www.iamdevbox.com/favicon-96x96.png\""
              }
            },
            "image": {
              "@type": "ImageObject",
              "url": "\"https://www.iamdevbox.com/favicon-96x96.png\""
            },
            "datePublished": "2025-06-09T14:56:04Z",
            "dateModified": "2025-06-09T14:56:16Z"
          },
          {
            "@type": "Article",
            "mainEntityOfPage": {
              "@type": "WebPage",
              "@id": "https:\/\/www.iamdevbox.com\/posts\/orchestrating-kubernetes-and-iam-with-terraform-a-comprehensive-guide\/"
            },
            "headline": "\"Orchestrating Kubernetes and IAM with Terraform: A Comprehensive Guide\"",
            "author": {
              "@type": "Person",
              "name": "IAMDevBox"
            },
            "publisher": {
              "@type": "Organization",
              "name": "IAMDevBox",
              "logo": {
                "@type": "ImageObject",
                "url": "\"https://www.iamdevbox.com/favicon-96x96.png\""
              }
            },
            "image": {
              "@type": "ImageObject",
              "url": "\"https://www.iamdevbox.com/favicon-96x96.png\""
            },
            "datePublished": "2025-06-08T13:49:52Z",
            "dateModified": "2025-06-08T09:53:31-04:00"
          },
          {
            "@type": "Article",
            "mainEntityOfPage": {
              "@type": "WebPage",
              "@id": "https:\/\/www.iamdevbox.com\/posts\/navigating-iam-challenges-in-multi-cloud-environments\/"
            },
            "headline": "\"Navigating IAM Challenges in Multi-Cloud Environments\"",
            "author": {
              "@type": "Person",
              "name": "IAMDevBox"
            },
            "publisher": {
              "@type": "Organization",
              "name": "IAMDevBox",
              "logo": {
                "@type": "ImageObject",
                "url": "\"https://www.iamdevbox.com/favicon-96x96.png\""
              }
            },
            "image": {
              "@type": "ImageObject",
              "url": "\"https://www.iamdevbox.com/favicon-96x96.png\""
            },
            "datePublished": "2025-06-06T14:59:32Z",
            "dateModified": "2025-06-06T19:33:33-04:00"
          }
  ]
}
</script>
    <script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": [
    {
      "@type": "Question",
      "name": "\"Why Use PKCE with Spring Boot?\"",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "\"Please refer to the article for detailed explanation.\""
      }
    },
    {
      "@type": "Question",
      "name": "\"Can you combine PKCE with Refresh Token Rotation securely?\"",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "\"Please refer to the article for detailed explanation.\""
      }
    },
    {
      "@type": "Question",
      "name": "\"How would you handle PKCE flow in a multi-tenant SaaS app?\"",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "\"Please refer to the article for detailed explanation.\""
      }
    },
    {
      "@type": "Question",
      "name": "\"Should confidential clients also implement PKCE?\"",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "\"Please refer to the article for detailed explanation.\""
      }
    }
  ]
}
</script>
    
    <script>
    document.addEventListener("DOMContentLoaded", () => {
    if (document.querySelector('.mermaid')) {
        const script = document.createElement('script');
        script.src = "https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js";
        script.onload = () => {
        mermaid.initialize({ startOnLoad: true, theme: "default" });
        };
        document.head.appendChild(script);
    }
    });
    </script>

    
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-B6QCH29975"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-B6QCH29975');
    </script>
    
    
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://www.iamdevbox.com/" accesskey="h" title="IAMDevBox (Alt + H)">IAMDevBox</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://www.iamdevbox.com/posts/" title="Read articles and updates">
                    <span>Blog</span>
                </a>
            </li>
            <li>
                <a href="https://www.iamdevbox.com/tools/" title="Explore developer tools">
                    <span>🧰Tools</span>
                </a>
            </li>
            <li>
                <a href="https://www.iamdevbox.com/contact/" title="Contact">
                    <span>Contact</span>
                </a>
            </li>
            <li>
                <a href="https://www.iamdevbox.com/search/" title="Search this site">
                    <span>🔍</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://www.iamdevbox.com/">Home</a>&nbsp;»&nbsp;<a href="https://www.iamdevbox.com/posts/">All posts</a></div>
    <h1 class="post-title entry-hint-parent">
      Building a Secure PKCE Flow with Kotlin and Spring Boot
    </h1>
    
    <div class="post-meta">3 min&nbsp;·&nbsp;589 words&nbsp;·&nbsp;IAMDevBox

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#why-use-pkce-with-spring-boot" aria-label="Why Use PKCE with Spring Boot?">Why Use PKCE with Spring Boot?</a></li>
                <li>
                    <a href="#pkce-flow-recap" aria-label="PKCE Flow Recap">PKCE Flow Recap</a></li>
                <li>
                    <a href="#step-1-generate-code-verifier-and-code-challenge" aria-label="Step 1: Generate Code Verifier and Code Challenge">Step 1: Generate Code Verifier and Code Challenge</a></li>
                <li>
                    <a href="#step-2-build-authorization-url-with-pkce" aria-label="Step 2: Build Authorization URL with PKCE">Step 2: Build Authorization URL with PKCE</a></li>
                <li>
                    <a href="#step-3-exchange-authorization-code-for-token" aria-label="Step 3: Exchange Authorization Code for Token">Step 3: Exchange Authorization Code for Token</a></li>
                <li>
                    <a href="#real-world-considerations" aria-label="Real-World Considerations">Real-World Considerations</a></li>
                <li>
                    <a href="#use-with-forgerock-or-identity-providers" aria-label="Use with ForgeRock or Identity Providers">Use with ForgeRock or Identity Providers</a></li>
                <li>
                    <a href="#conclusion" aria-label="Conclusion">Conclusion</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><p>Proof Key for Code Exchange (PKCE) has become a standard security enhancement to the OAuth 2.0 Authorization Code Flow—especially in public clients like mobile and single-page applications. But PKCE isn&rsquo;t just for frontend apps. When combined with a stateless backend built with Kotlin and Spring Boot, it strengthens your security posture, particularly when you&rsquo;re avoiding client secrets.</p>
<p>This guide walks you through how to implement a secure PKCE flow using Kotlin and Spring Boot, including endpoint structure, code challenge generation, and token exchange.</p>
<hr>
<h3 id="why-use-pkce-with-spring-boot"><strong>Why Use PKCE with Spring Boot?</strong><a hidden class="anchor" aria-hidden="true" href="#why-use-pkce-with-spring-boot">#</a></h3>
<p>PKCE was designed to protect public clients from authorization code interception attacks. But it also benefits backend applications that:</p>
<ul>
<li>Don&rsquo;t want to manage confidential client secrets.</li>
<li>Support both browser and native app clients.</li>
<li>Need flexible OAuth 2.0 integrations with high security.</li>
</ul>
<p>While Spring Security supports OAuth 2.0 out of the box, PKCE is not always enabled by default in backend flows, and it requires custom configuration.</p>
<hr>
<h3 id="pkce-flow-recap"><strong>PKCE Flow Recap</strong><a hidden class="anchor" aria-hidden="true" href="#pkce-flow-recap">#</a></h3>
<p>The PKCE-enhanced flow works as follows:</p>
<ol>
<li>Client generates a <code>code_verifier</code> and a hashed <code>code_challenge</code>.</li>
<li>It starts the OAuth 2.0 authorization request with the <code>code_challenge</code>.</li>
<li>The user authenticates and the authorization server returns a code.</li>
<li>The client exchanges the code for a token using the <code>code_verifier</code>.</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>+--------+                                   +---------------+
</span></span><span style="display:flex;"><span>|        |--(A)- Authorization Request ------&gt;|               |
</span></span><span style="display:flex;"><span>|        |       code_challenge (+ method)   |               |
</span></span><span style="display:flex;"><span>|        |                                   | Authorization |
</span></span><span style="display:flex;"><span>| Client |&lt;-(B)---- Authorization Code -------|     Server    |
</span></span><span style="display:flex;"><span>|        |                                   |               |
</span></span><span style="display:flex;"><span>|        |--(C)-- Token Request --------------&gt;|               |
</span></span><span style="display:flex;"><span>|        |         code_verifier             |               |
</span></span><span style="display:flex;"><span>|        |&lt;-(D)----- Access Token -------------|               |
</span></span><span style="display:flex;"><span>+--------+                                   +---------------+
</span></span></code></pre></div><hr>
<h3 id="step-1-generate-code-verifier-and-code-challenge"><strong>Step 1: Generate Code Verifier and Code Challenge</strong><a hidden class="anchor" aria-hidden="true" href="#step-1-generate-code-verifier-and-code-challenge">#</a></h3>
<p>You can generate the code verifier and challenge in Kotlin like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#75715e">// Kotlin snippet to generate code_verifier and code_challenge
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">val</span> secureRandom = SecureRandom()
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">val</span> codeVerifier = Base64.getUrlEncoder().withoutPadding().encodeToString(
</span></span><span style="display:flex;"><span>    ByteArray(<span style="color:#ae81ff">32</span>).apply { secureRandom.nextBytes(<span style="color:#66d9ef">this</span>) }
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">val</span> digest = <span style="color:#a6e22e">MessageDigest</span>.getInstance(<span style="color:#e6db74">&#34;SHA-256&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">val</span> hashed = digest.digest(codeVerifier.toByteArray(<span style="color:#a6e22e">StandardCharsets</span>.US_ASCII))
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">val</span> codeChallenge = Base64.getUrlEncoder().withoutPadding().encodeToString(hashed)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>println(<span style="color:#e6db74">&#34;Code Verifier: </span><span style="color:#e6db74">$codeVerifier</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>println(<span style="color:#e6db74">&#34;Code Challenge: </span><span style="color:#e6db74">$codeChallenge</span><span style="color:#e6db74">&#34;</span>)
</span></span></code></pre></div><p>Use the <code>code_challenge</code> in your authorization URL.</p>
<hr>
<h3 id="step-2-build-authorization-url-with-pkce"><strong>Step 2: Build Authorization URL with PKCE</strong><a hidden class="anchor" aria-hidden="true" href="#step-2-build-authorization-url-with-pkce">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#75715e">// Kotlin snippet to build authorization URL
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">val</span> authorizationUrl = UriComponentsBuilder
</span></span><span style="display:flex;"><span>    .fromUriString(<span style="color:#e6db74">&#34;https://your-oauth-server.com/oauth2/authorize&#34;</span>)
</span></span><span style="display:flex;"><span>    .queryParam(<span style="color:#e6db74">&#34;response_type&#34;</span>, <span style="color:#e6db74">&#34;code&#34;</span>)
</span></span><span style="display:flex;"><span>    .queryParam(<span style="color:#e6db74">&#34;client_id&#34;</span>, <span style="color:#e6db74">&#34;your-client-id&#34;</span>)
</span></span><span style="display:flex;"><span>    .queryParam(<span style="color:#e6db74">&#34;redirect_uri&#34;</span>, <span style="color:#e6db74">&#34;http://localhost:8080/callback&#34;</span>)
</span></span><span style="display:flex;"><span>    .queryParam(<span style="color:#e6db74">&#34;scope&#34;</span>, <span style="color:#e6db74">&#34;openid profile email&#34;</span>)
</span></span><span style="display:flex;"><span>    .queryParam(<span style="color:#e6db74">&#34;code_challenge&#34;</span>, codeChallenge)
</span></span><span style="display:flex;"><span>    .queryParam(<span style="color:#e6db74">&#34;code_challenge_method&#34;</span>, <span style="color:#e6db74">&#34;S256&#34;</span>)
</span></span><span style="display:flex;"><span>    .build()
</span></span><span style="display:flex;"><span>    .toUriString()
</span></span></code></pre></div><p>This URL redirects the user to the OAuth authorization server, where they will login and authorize the app.</p>
<hr>
<h3 id="step-3-exchange-authorization-code-for-token"><strong>Step 3: Exchange Authorization Code for Token</strong><a hidden class="anchor" aria-hidden="true" href="#step-3-exchange-authorization-code-for-token">#</a></h3>
<p>Once you receive the authorization <code>code</code>, exchange it for tokens:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#75715e">// Spring WebClient example with PKCE token request
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">val</span> response = webClient.post()
</span></span><span style="display:flex;"><span>    .uri(<span style="color:#e6db74">&#34;https://your-oauth-server.com/oauth2/token&#34;</span>)
</span></span><span style="display:flex;"><span>    .body(<span style="color:#a6e22e">BodyInserters</span>.fromFormData(<span style="color:#e6db74">&#34;grant_type&#34;</span>, <span style="color:#e6db74">&#34;authorization_code&#34;</span>)
</span></span><span style="display:flex;"><span>        .with(<span style="color:#e6db74">&#34;client_id&#34;</span>, <span style="color:#e6db74">&#34;your-client-id&#34;</span>)
</span></span><span style="display:flex;"><span>        .with(<span style="color:#e6db74">&#34;redirect_uri&#34;</span>, <span style="color:#e6db74">&#34;http://localhost:8080/callback&#34;</span>)
</span></span><span style="display:flex;"><span>        .with(<span style="color:#e6db74">&#34;code&#34;</span>, receivedCode)
</span></span><span style="display:flex;"><span>        .with(<span style="color:#e6db74">&#34;code_verifier&#34;</span>, codeVerifier))
</span></span><span style="display:flex;"><span>    .retrieve()
</span></span><span style="display:flex;"><span>    .bodyToMono(TokenResponse<span style="color:#f92672">::</span><span style="color:#66d9ef">class</span>.java)
</span></span><span style="display:flex;"><span>    .block()
</span></span></code></pre></div><p>Define <code>TokenResponse</code> as a data class for mapping token results.</p>
<hr>
<h3 id="real-world-considerations"><strong>Real-World Considerations</strong><a hidden class="anchor" aria-hidden="true" href="#real-world-considerations">#</a></h3>
<ul>
<li>Rotate <code>code_verifier</code> per request; never reuse.</li>
<li>Use HTTPS for all token and authorization exchanges.</li>
<li>PKCE flow complements rather than replaces your need for secure storage (especially refresh tokens).</li>
</ul>
<hr>
<h3 id="use-with-forgerock-or-identity-providers"><strong>Use with ForgeRock or Identity Providers</strong><a hidden class="anchor" aria-hidden="true" href="#use-with-forgerock-or-identity-providers">#</a></h3>
<p>ForgeRock Identity Cloud supports PKCE natively. You can easily enable it in your client configuration.
<strong>👉 Related:</strong> <a href="/posts/understanding-the-authorization-code-flow-with-pkce-in-oauth-20/">Understanding the Authorization Code Flow with PKCE in OAuth 2.0</a></p>
<p><strong>👉 Related:</strong> <a href="/posts/building-complete-oidc-login-flow-urls-in-forgerock-identity-cloud/">Building Complete OIDC Login Flow URLs in ForgeRock Identity Cloud</a></p>
<hr>
<h3 id="conclusion"><strong>Conclusion</strong><a hidden class="anchor" aria-hidden="true" href="#conclusion">#</a></h3>
<p>Using PKCE with Kotlin and Spring Boot isn&rsquo;t just about mobile support—it’s a general OAuth 2.0 best practice. It protects your applications from malicious code interception while maintaining high developer agility.</p>
<p>Whether you&rsquo;re working on a microservice backend, BFF layer, or hybrid app, PKCE is a lightweight security upgrade worth adopting.</p>
<p>🔍 <strong>What’s Next?</strong></p>
<ul>
<li>Can you combine PKCE with Refresh Token Rotation securely?</li>
<li>How would you handle PKCE flow in a multi-tenant SaaS app?</li>
<li>Should confidential clients also implement PKCE?</li>
</ul>
<p>Let’s explore more in the next post.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://www.iamdevbox.com/tags/oauth-2.0/">OAuth 2.0</a></li>
      <li><a href="https://www.iamdevbox.com/tags/pkce/">PKCE</a></li>
      <li><a href="https://www.iamdevbox.com/tags/kotlin/">Kotlin</a></li>
      <li><a href="https://www.iamdevbox.com/tags/spring-boot/">Spring Boot</a></li>
      <li><a href="https://www.iamdevbox.com/tags/secure-authentication/">Secure Authentication</a></li>
      <li><a href="https://www.iamdevbox.com/tags/authorization-code-flow/">Authorization Code Flow</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://www.iamdevbox.com/posts/integrating-oauth-20-with-react-spa-using-backend-for-frontend-bff/">
    <span class="title">« Prev</span>
    <br>
    <span>Integrating OAuth 2.0 with React SPA using Backend-for-Frontend (BFF)</span>
  </a>
  <a class="next" href="https://www.iamdevbox.com/posts/how-to-introspect-oauth-20-tokens-and-validate-their-status-in-real-time/">
    <span class="title">Next »</span>
    <br>
    <span>How to Introspect OAuth 2.0 Tokens and Validate Their Status in Real Time</span>
  </a>
</nav>

  </footer>

  
  

  
  <section class="post-related-articles custom-section">
    <h2 class="custom-section-title">
      Related Articles
    </h2>
    
    
    <ul class="custom-list">
      
      
        
          <li class="custom-list-item">
            <a href="/posts/building-unified-identity-strategy-in-multi-cloud-environments/" class="custom-link">
              Building Unified Identity Strategy in Multi-Cloud Environments
            </a>
            <small class="custom-date">2025-06-04</small>
          </li>
          
        
      
        
          <li class="custom-list-item">
            <a href="/posts/oauth-20-token-introspection-real-time-validation-explained/" class="custom-link">
              OAuth 2.0 Token Introspection: Real-Time Validation Explained
            </a>
            <small class="custom-date">2025-06-04</small>
          </li>
          
        
      
        
          <li class="custom-list-item">
            <a href="/posts/oauth-21-whats-changing-and-why-it-matters/" class="custom-link">
              OAuth 2.1: What’s Changing and Why It Matters
            </a>
            <small class="custom-date">2025-06-04</small>
          </li>
          
        
      
        
          <li class="custom-list-item">
            <a href="/posts/understanding-token-revocation-and-when-to-use-it/" class="custom-link">
              Understanding Token Revocation and When to Use It
            </a>
            <small class="custom-date">2025-06-04</small>
          </li>
          
        
      
        
          <li class="custom-list-item">
            <a href="/posts/how-we-solved-token-misrouting-in-forgerock-identity-cloud/" class="custom-link">
              How We Solved Token Misrouting in ForgeRock Identity Cloud
            </a>
            <small class="custom-date">2025-06-04</small>
          </li>
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      

      
    </ul>

    
      <div class="custom-more">
        <a href="/posts/" class="custom-link">
          More &raquo;
        </a>
      </div>
    
  </section>
  

  <section class="post-recent-articles custom-section-alt">
    <h2 class="custom-section-title">
      Latest Articles
    </h2>
    
    
    
    <ul class="custom-list">
      
      
        
          
            <li class="custom-list-item">
              <a href="/posts/devops-is-not-just-tools--its-a-cultural-transformation/" class="custom-link">
                DevOps Is Not Just Tools — It’s a Cultural Transformation
              </a>
              <small class="custom-date">2025-06-09</small>
            </li>
            
          
        
      
        
          
            <li class="custom-list-item">
              <a href="/posts/orchestrating-kubernetes-and-iam-with-terraform-a-comprehensive-guide/" class="custom-link">
                Orchestrating Kubernetes and IAM with Terraform: A Comprehensive Guide
              </a>
              <small class="custom-date">2025-06-08</small>
            </li>
            
          
        
      
        
          
            <li class="custom-list-item">
              <a href="/posts/navigating-iam-challenges-in-multi-cloud-environments/" class="custom-link">
                Navigating IAM Challenges in Multi-Cloud Environments
              </a>
              <small class="custom-date">2025-06-06</small>
            </li>
            
          
        
      
        
          
            <li class="custom-list-item">
              <a href="/posts/best-practices-for-writing-java-dockerfiles/" class="custom-link">
                Best Practices for Writing Java Dockerfiles
              </a>
              <small class="custom-date">2025-06-05</small>
            </li>
            
          
        
      
        
          
            <li class="custom-list-item">
              <a href="/posts/building-unified-identity-strategy-in-multi-cloud-environments/" class="custom-link">
                Building Unified Identity Strategy in Multi-Cloud Environments
              </a>
              <small class="custom-date">2025-06-04</small>
            </li>
            
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
    </ul>

    
      <div class="custom-more">
        <a href="/posts/" class="custom-link">
          More &raquo;
        </a>
      </div>
    
  </section>
</article>
    </main>
    
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://www.iamdevbox.com/">IAMDevBox</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        window.requestAnimationFrame(() => {
            const savedScroll = localStorage.getItem("menu-scroll-position");
            if (savedScroll !== null) {
            menu.scrollLeft = savedScroll;
            }
        });

        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        };
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
