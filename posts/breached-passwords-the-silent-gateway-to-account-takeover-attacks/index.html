<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Breached Passwords: The Silent Gateway to Account Takeove...</title><meta name="description" content="In the ever-evolving landscape of cybersecurity, one threat stands out as particularly insidious: Account Takeover (ATO) attacks. These attacks exploit the..."><meta name="keywords" content="Account Takeover (ATO, Password Security, Cybersecurity, Breached Passwords, Authentication"><meta name="author" content="IAMDevBox"><meta name="language" content="en-US">
<meta property="og:locale" content="en_US"><link rel="canonical" href="https://www.iamdevbox.com/posts/breached-passwords-the-silent-gateway-to-account-takeover-attacks/"><meta property="og:title" content="Breached Passwords: The Silent Gateway to Account Takeove...">
<meta property="og:description" content="In the ever-evolving landscape of cybersecurity, one threat stands out as particularly insidious: Account Takeover (ATO) attacks. These attacks exploit the...">
<meta property="og:type" content="article">
<meta property="og:url" content="https://www.iamdevbox.com/posts/breached-passwords-the-silent-gateway-to-account-takeover-attacks/">
<meta property="og:site_name" content="IAMDevBox">
<meta property="og:image" content="https://www.iamdevbox.com/IAMDevBox.com.jpg">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<meta property="og:image:alt" content="IAMDevBox - Identity and Access Management Blog"><meta property="article:published_time" content="2025-05-22T11:51:41Z">
<meta property="article:modified_time" content="2025-06-11T14:30:31-04:00">
<meta property="article:author" content="IAMDevBox">
<meta property="article:section" content="Posts"><meta property="article:tag" content="Account Takeover (ATO"><meta property="article:tag" content="Password Security"><meta property="article:tag" content="Cybersecurity"><meta property="article:tag" content="Breached Passwords"><meta property="article:tag" content="Authentication"><meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Breached Passwords: The Silent Gateway to Account Takeove...">
<meta name="twitter:description" content="In the ever-evolving landscape of cybersecurity, one threat stands out as particularly insidious: Account Takeover (ATO) attacks. These attacks exploit the...">
<meta name="twitter:image" content="https://www.iamdevbox.com/IAMDevBox.com.jpg"><meta name="twitter:site" content="@iamdevbox"><meta name="twitter:creator" content="@iamdevbox"><meta name="format-detection" content="telephone=no">
<meta name="theme-color" content="#2e2e33"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin>
<link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="//www.google-analytics.com">
<link rel="dns-prefetch" href="//fonts.googleapis.com">
<link rel="dns-prefetch" href="//fonts.gstatic.com"><script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Breached Passwords: The Silent Gateway to Account Takeover Attacks",
  "description": "In the ever-evolving landscape of cybersecurity, one threat stands out as particularly insidious: Account Takeover (ATO) attacks. These attacks exploit the...",
  "image": "https:\/\/www.iamdevbox.com\/IAMDevBox.com.jpg",
  "author": {
    "@type": "Person",
    "name": "IAMDevBox"
  },
  "publisher": {
    "@type": "Organization",
    "name": "IAMDevBox",
    "logo": {
      "@type": "ImageObject",
      "url": "https:\/\/www.iamdevbox.com\/IAMDevBox.com.png"
    }
  },
  "datePublished": "2025-05-22T11:51:41Z",
  "dateModified": "2025-06-11T14:30:31-04:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https:\/\/www.iamdevbox.com\/posts\/breached-passwords-the-silent-gateway-to-account-takeover-attacks\/"
  },
  "wordCount":  849 ,
  "keywords": "[\"Account Takeover (ATO\",\"Password Security\",\"Cybersecurity\",\"Breached Passwords\",\"Authentication\"]"
}
</script><script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Home",
      "item": "https:\/\/www.iamdevbox.com\/"
    },
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Blog",
      "item": "https:\/\/www.iamdevbox.com\/posts\/"
    },
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "Breached Passwords: The Silent Gateway to Account Takeover Attacks",
      "item": "https:\/\/www.iamdevbox.com\/posts\/breached-passwords-the-silent-gateway-to-account-takeover-attacks\/"
    }]
}
</script>
<link crossorigin="anonymous" href="/assets/css/stylesheet.93f625d739f1d6a5c6f20c146bc6a8d26b233492b34b2220c54b12fd46a04ded.css" integrity="sha256-k/Yl1znx1qXG8gwUa8ao0msjNJKzSyIgxUsS/UagTe0=" rel="preload stylesheet" as="style">


<link rel="icon" href="https://www.iamdevbox.com/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://www.iamdevbox.com/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://www.iamdevbox.com/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://www.iamdevbox.com/apple-touch-icon.png">
<link rel="mask-icon" href="https://www.iamdevbox.com/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://www.iamdevbox.com/posts/breached-passwords-the-silent-gateway-to-account-takeover-attacks/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>

<link rel="stylesheet" href="/css/custom.min.f87e4df74f4f070695effe5d49ae4914eb9228356e4300800036f51859f72d47.css" media="print" onload="this.media='all'">
<noscript><link rel="stylesheet" href="/css/custom.min.f87e4df74f4f070695effe5d49ae4914eb9228356e4300800036f51859f72d47.css"></noscript>

<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<meta property="og:url" content="https://www.iamdevbox.com/posts/breached-passwords-the-silent-gateway-to-account-takeover-attacks/">
  <meta property="og:site_name" content="IAMDevBox">
  <meta property="og:title" content="Breached Passwords: The Silent Gateway to Account Takeover Attacks">
  <meta property="og:description" content="In the ever-evolving landscape of cybersecurity, one threat stands out as particularly insidious: Account Takeover (ATO) attacks. These attacks exploit the...">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-05-22T11:51:41+00:00">
    <meta property="article:modified_time" content="2025-06-11T14:30:31-04:00">
    <meta property="article:tag" content="Account Takeover (ATO">
    <meta property="article:tag" content="Password Security">
    <meta property="article:tag" content="Cybersecurity">
    <meta property="article:tag" content="Breached Passwords">
    <meta property="article:tag" content="Authentication">
      <meta property="og:image" content="https://www.iamdevbox.com/IAMDevBox.com.jpg">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://www.iamdevbox.com/IAMDevBox.com.jpg">
<meta name="twitter:title" content="Breached Passwords: The Silent Gateway to Account Takeover Attacks">
<meta name="twitter:description" content="In the ever-evolving landscape of cybersecurity, one threat stands out as particularly insidious: Account Takeover (ATO) attacks. These attacks exploit the...">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "All posts",
      "item": "https://www.iamdevbox.com/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Breached Passwords: The Silent Gateway to Account Takeover Attacks",
      "item": "https://www.iamdevbox.com/posts/breached-passwords-the-silent-gateway-to-account-takeover-attacks/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Breached Passwords: The Silent Gateway to Account Takeover Attacks",
  "name": "Breached Passwords: The Silent Gateway to Account Takeover Attacks",
  "description": "In the ever-evolving landscape of cybersecurity, one threat stands out as particularly insidious: Account Takeover (ATO) attacks. These attacks exploit the...",
  "keywords": [
    "Account Takeover (ATO", "Password Security", "Cybersecurity", "Breached Passwords", "Authentication"
  ],
  "articleBody": "In the ever-evolving landscape of cybersecurity, one threat stands out as particularly insidious: Account Takeover (ATO) attacks. These attacks exploit the widespread use of weak, reused, or breached passwords, enabling attackers to gain unauthorized access to user accounts. Once an attacker controls an account, the consequences can be severe, ranging from financial loss to reputational damage. In this blog post, we‚Äôll delve into how breached passwords pave the way for ATO attacks, explore real-world examples, and discuss strategies to mitigate this growing threat.\nThe Password Predicament Passwords remain the cornerstone of digital authentication, despite their well-documented flaws. The problem? Users often reuse the same password across multiple platforms. When one account is compromised in a data breach, attackers can use that password to infiltrate other accounts, a process known as ‚Äúcredential stuffing.‚Äù\nFor example, consider the 2018 Marriott data breach, where attackers accessed the personal information of 500 million guests. Among the stolen data were email addresses and encrypted passwords. Cybercriminals could use these credentials to attempt logins on other platforms, such as banking or e-commerce sites, potentially leading to ATOs.\nDiagram: Credential Stuffing in Action [Account A (Breach)] ‚Üí [Stolen Credentials] ‚Üí [Credential Stuffing] ‚Üí [Account B (ATO)] How Account Takeover Attacks Work ATO attacks typically follow a predictable pattern:\nCredential Acquisition: Attackers obtain stolen credentials from data breaches, phishing campaigns, or malware infections. Credential Stuffing: They use automated tools to test these credentials on other platforms, exploiting password reuse. Account Compromise: If the credentials work, the attacker gains unauthorized access to the account. Leverage and Exploitation: The attacker can then use the compromised account for further malicious activities, such as: Financial Fraud: Making unauthorized transactions or draining accounts. Identity Theft: Using the account to steal sensitive personal information. Reputation Damage: Posting malicious content or spreading phishing links. Real-World Example: The Twitter Hack of 2020 In July 2020, a coordinated ATO attack compromised high-profile Twitter accounts, including those of Barack Obama, Joe Biden, and Elon Musk. Attackers gained access to Twitter‚Äôs internal tools by exploiting compromised employee credentials, which were likely obtained through a phishing campaign. Once inside, they used these tools to take over high-value user accounts and post fraudulent Bitcoin scams. The incident underscored the importance of securing both user and administrative accounts.\nThe Evolution of ATO Attacks ATO attacks are not a new phenomenon, but their sophistication and scale have increased significantly in recent years. Attackers now use advanced techniques, such as:\nAI-Powered Credential Stuffing: Machine learning algorithms can optimize credential stuffing attacks by identifying patterns in successful logins. Multi-Vector Attacks: Combining ATOs with other attack vectors, such as phishing or social engineering, to increase success rates. Monetization-as-a-Service: Cybercriminals can now rent ATO tools and services on darknet marketplaces, lowering the barrier to entry for would-be attackers. Diagram: The Modern ATO Attack Chain [Stolen Credentials] ‚Üí [Automated Credential Stuffing] ‚Üí [Account Compromise] ‚Üí [Monetization] Mitigating Account Takeover Attacks Organizations and individuals must adopt a proactive approach to combat ATO attacks. Here are some key strategies:\n1. Enforce Strong Password Policies Require users to create complex, unique passwords. Ban the reuse of previously breached passwords. Implement password managers to help users generate and store secure passwords. 2. Implement Multi-Factor Authentication (MFA) MFA adds an extra layer of security by requiring users to provide two or more forms of verification (e.g., a password and a one-time code). Even if an attacker obtains a user‚Äôs password, they cannot access the account without the second factor.\n3. Monitor for Anomalous Activity Use advanced analytics and AI-driven security tools to detect suspicious login attempts or behavioral anomalies that may indicate an ATO.\n4. Educate Users Raise awareness about the risks of password reuse and the importance of securing accounts with MFA. Provide users with resources to check if their credentials have been compromised (e.g., haveibeenpwned.com).\n5. Secure APIs and Internal Tools As seen in the Twitter hack, attackers often target internal tools and APIs to gain access to user accounts. Ensure that these systems are secured with robust authentication and authorization mechanisms.\nCode Example: Implementing Password Hashing and MFA Here‚Äôs a simple example of how to implement password hashing and MFA in a web application:\n# Password Hashing from passlib.context import CryptContext pwd_context = CryptContext(schemes=[\"bcrypt\"], deprecated=\"auto\") def hash_password(password: str) -\u003e str: return pwd_context.hash(password) def verify_password(plain_password: str, hashed_password: str) -\u003e bool: return pwd_context.verify(plain_password, hashed_password) # MFA Implementation (Simplified) import pyotp def generate_otp_secret() -\u003e str: return pyotp.random_base32() def verify_otp(token: str, secret: str) -\u003e bool: totp = pyotp.TOTP(secret) return totp.verify(token) Conclusion Breached passwords are a ticking time bomb, and ATO attacks are the inevitable explosion. Organizations must prioritize password security, implement MFA, and adopt proactive monitoring to stay ahead of cybercriminals. By taking these steps, we can reduce the risk of ATO attacks and protect user accounts from falling into the wrong hands.\nExtended Questions for Readers How does your organization handle password security and MFA implementation? Have you ever experienced an ATO attack? What steps did you take to recover? How can businesses better educate users about the risks of password reuse? Let me know your thoughts in the comments below! üõ°Ô∏è\n",
  "wordCount" : "849",
  "inLanguage": "en",
  "image": "https://www.iamdevbox.com/IAMDevBox.com.jpg","datePublished": "2025-05-22T11:51:41Z",
  "dateModified": "2025-06-11T14:30:31-04:00",
  "author":{
    "@type": "Person",
    "name": "IAMDevBox"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.iamdevbox.com/posts/breached-passwords-the-silent-gateway-to-account-takeover-attacks/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "IAMDevBox",
    "logo": {
      "@type": "ImageObject",
      "url": "https://www.iamdevbox.com/favicon.ico"
    }
  }
}
</script><meta name="description" content="In the ever-evolving landscape of cybersecurity, one threat stands out as particularly insidious: Account Takeover (ATO) attacks. These attacks exploit the...">
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@graph": [
          {
            "@type": "Article",
            "mainEntityOfPage": {
              "@type": "WebPage",
              "@id": "https:\/\/www.iamdevbox.com\/posts\/is-jwt-decoding-safe-on-the-frontend-security-risks-you-should-know\/"
            },
            "headline": "\"Is JWT Decoding Safe on the Frontend? Security Risks You Should Know\"",
            "author": {
              "@type": "Person",
              "name": "IAMDevBox"
            },
            "publisher": {
              "@type": "Organization",
              "name": "IAMDevBox",
              "logo": {
                "@type": "ImageObject",
                "url": "\"https://www.iamdevbox.com/favicon-96x96.png\""
              }
            },
            "image": {
              "@type": "ImageObject",
              "url": "\"https://www.iamdevbox.com/favicon-96x96.png\""
            },
            "datePublished": "2025-08-28T14:53:37Z",
            "dateModified": "2025-08-28T14:53:52Z"
          },
          {
            "@type": "Article",
            "mainEntityOfPage": {
              "@type": "WebPage",
              "@id": "https:\/\/www.iamdevbox.com\/posts\/what-is-a-jwt-and-how-does-it-work-a-developer-friendly-introduction\/"
            },
            "headline": "\"What Is a JWT and How Does It Work? A Developer-Friendly Introduction\"",
            "author": {
              "@type": "Person",
              "name": "IAMDevBox"
            },
            "publisher": {
              "@type": "Organization",
              "name": "IAMDevBox",
              "logo": {
                "@type": "ImageObject",
                "url": "\"https://www.iamdevbox.com/favicon-96x96.png\""
              }
            },
            "image": {
              "@type": "ImageObject",
              "url": "\"https://www.iamdevbox.com/favicon-96x96.png\""
            },
            "datePublished": "2025-08-26T15:13:56Z",
            "dateModified": "2025-08-26T15:14:09Z"
          },
          {
            "@type": "Article",
            "mainEntityOfPage": {
              "@type": "WebPage",
              "@id": "https:\/\/www.iamdevbox.com\/posts\/build-your-own-jwt-decode-online-tool-with-firebase-functions-and-react\/"
            },
            "headline": "\"Build Your Own JWT Decode Online Tool with Firebase Functions and React\"",
            "author": {
              "@type": "Person",
              "name": "IAMDevBox"
            },
            "publisher": {
              "@type": "Organization",
              "name": "IAMDevBox",
              "logo": {
                "@type": "ImageObject",
                "url": "\"https://www.iamdevbox.com/favicon-96x96.png\""
              }
            },
            "image": {
              "@type": "ImageObject",
              "url": "\"https://www.iamdevbox.com/favicon-96x96.png\""
            },
            "datePublished": "2025-08-25T19:38:05Z",
            "dateModified": "2025-08-25T19:38:19Z"
          }
  ]
}
</script>
    <script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": [
    {
      "@type": "Question",
      "name": "\"How does your organization handle password security and MFA implementation?\"",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "\"Please refer to the article for detailed explanation.\""
      }
    },
    {
      "@type": "Question",
      "name": "\"Have you ever experienced an ATO attack?\"",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "\"Please refer to the article for detailed explanation.\""
      }
    },
    {
      "@type": "Question",
      "name": "\"What steps did you take to recover?\"",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "\"Please refer to the article for detailed explanation.\""
      }
    },
    {
      "@type": "Question",
      "name": "\"How can businesses better educate users about the risks of password reuse?\"",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "\"Please refer to the article for detailed explanation.\""
      }
    }
  ]
}
</script>
    
    <script>
    document.addEventListener("DOMContentLoaded", () => {
    if (document.querySelector('.mermaid')) {
        const script = document.createElement('script');
        script.src = "https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js";
        script.onload = () => {
        mermaid.initialize({ startOnLoad: true, theme: "default" });
        };
        document.head.appendChild(script);
    }
    });
    </script>

    
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-B6QCH29975"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-B6QCH29975');
    </script>
    
    
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://www.iamdevbox.com/" accesskey="h" title="IAMDevBox (Alt + H)">IAMDevBox</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://www.iamdevbox.com/posts/" title="Read articles and updates">
                    <span>Blog</span>
                </a>
            </li>
            <li>
                <a href="https://www.iamdevbox.com/tools/" title="Explore developer tools">
                    <span>üß∞Tools</span>
                </a>
            </li>
            <li>
                <a href="https://www.iamdevbox.com/contact/" title="Contact">
                    <span>Contact</span>
                </a>
            </li>
            <li>
                <a href="https://www.iamdevbox.com/search/" title="Search this site">
                    <span>üîç</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://www.iamdevbox.com/">Home</a>&nbsp;¬ª&nbsp;<a href="https://www.iamdevbox.com/posts/">All posts</a></div>
    <h1 class="post-title entry-hint-parent">
      Breached Passwords: The Silent Gateway to Account Takeover Attacks
    </h1>
    
    <div class="post-meta">4 min&nbsp;¬∑&nbsp;849 words&nbsp;¬∑&nbsp;IAMDevBox

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#the-password-predicament" aria-label="The Password Predicament">The Password Predicament</a><ul>
                        
                <li>
                    <a href="#diagram-credential-stuffing-in-action" aria-label="Diagram: Credential Stuffing in Action">Diagram: Credential Stuffing in Action</a></li></ul>
                </li>
                <li>
                    <a href="#how-account-takeover-attacks-work" aria-label="How Account Takeover Attacks Work">How Account Takeover Attacks Work</a><ul>
                        
                <li>
                    <a href="#real-world-example-the-twitter-hack-of-2020" aria-label="Real-World Example: The Twitter Hack of 2020">Real-World Example: The Twitter Hack of 2020</a></li></ul>
                </li>
                <li>
                    <a href="#the-evolution-of-ato-attacks" aria-label="The Evolution of ATO Attacks">The Evolution of ATO Attacks</a><ul>
                        
                <li>
                    <a href="#diagram-the-modern-ato-attack-chain" aria-label="Diagram: The Modern ATO Attack Chain">Diagram: The Modern ATO Attack Chain</a></li></ul>
                </li>
                <li>
                    <a href="#mitigating-account-takeover-attacks" aria-label="Mitigating Account Takeover Attacks">Mitigating Account Takeover Attacks</a><ul>
                        
                <li>
                    <a href="#1-enforce-strong-password-policies" aria-label="1. Enforce Strong Password Policies">1. Enforce Strong Password Policies</a></li>
                <li>
                    <a href="#2-implement-multi-factor-authentication-mfa" aria-label="2. Implement Multi-Factor Authentication (MFA)">2. Implement Multi-Factor Authentication (MFA)</a></li>
                <li>
                    <a href="#3-monitor-for-anomalous-activity" aria-label="3. Monitor for Anomalous Activity">3. Monitor for Anomalous Activity</a></li>
                <li>
                    <a href="#4-educate-users" aria-label="4. Educate Users">4. Educate Users</a></li>
                <li>
                    <a href="#5-secure-apis-and-internal-tools" aria-label="5. Secure APIs and Internal Tools">5. Secure APIs and Internal Tools</a></li></ul>
                </li>
                <li>
                    <a href="#code-example-implementing-password-hashing-and-mfa" aria-label="Code Example: Implementing Password Hashing and MFA">Code Example: Implementing Password Hashing and MFA</a></li>
                <li>
                    <a href="#conclusion" aria-label="Conclusion">Conclusion</a><ul>
                        
                <li>
                    <a href="#extended-questions-for-readers" aria-label="Extended Questions for Readers">Extended Questions for Readers</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><p>In the ever-evolving landscape of cybersecurity, one threat stands out as particularly insidious: Account Takeover (ATO) attacks. These attacks exploit the widespread use of weak, reused, or breached passwords, enabling attackers to gain unauthorized access to user accounts. Once an attacker controls an account, the consequences can be severe, ranging from financial loss to reputational damage. In this blog post, we‚Äôll delve into how breached passwords pave the way for ATO attacks, explore real-world examples, and discuss strategies to mitigate this growing threat.</p>
<hr>
<h3 id="the-password-predicament"><strong>The Password Predicament</strong><a hidden class="anchor" aria-hidden="true" href="#the-password-predicament">#</a></h3>
<p>Passwords remain the cornerstone of digital authentication, despite their well-documented flaws. The problem? Users often reuse the same password across multiple platforms. When one account is compromised in a data breach, attackers can use that password to infiltrate other accounts, a process known as &ldquo;credential stuffing.&rdquo;</p>
<p>For example, consider the 2018 Marriott data breach, where attackers accessed the personal information of 500 million guests. Among the stolen data were email addresses and encrypted passwords. Cybercriminals could use these credentials to attempt logins on other platforms, such as banking or e-commerce sites, potentially leading to ATOs.</p>
<h4 id="diagram-credential-stuffing-in-action"><strong>Diagram: Credential Stuffing in Action</strong><a hidden class="anchor" aria-hidden="true" href="#diagram-credential-stuffing-in-action">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>[Account A (Breach)] ‚Üí [Stolen Credentials] ‚Üí [Credential Stuffing] ‚Üí [Account B (ATO)]
</span></span></code></pre></div><hr>
<h3 id="how-account-takeover-attacks-work"><strong>How Account Takeover Attacks Work</strong><a hidden class="anchor" aria-hidden="true" href="#how-account-takeover-attacks-work">#</a></h3>
<p>ATO attacks typically follow a predictable pattern:</p>
<ol>
<li><strong>Credential Acquisition</strong>: Attackers obtain stolen credentials from data breaches, phishing campaigns, or malware infections.</li>
<li><strong>Credential Stuffing</strong>: They use automated tools to test these credentials on other platforms, exploiting password reuse.</li>
<li><strong>Account Compromise</strong>: If the credentials work, the attacker gains unauthorized access to the account.</li>
<li><strong>Leverage and Exploitation</strong>: The attacker can then use the compromised account for further malicious activities, such as:
<ul>
<li><strong>Financial Fraud</strong>: Making unauthorized transactions or draining accounts.</li>
<li><strong>Identity Theft</strong>: Using the account to steal sensitive personal information.</li>
<li><strong>Reputation Damage</strong>: Posting malicious content or spreading phishing links.</li>
</ul>
</li>
</ol>
<h4 id="real-world-example-the-twitter-hack-of-2020"><strong>Real-World Example: The Twitter Hack of 2020</strong><a hidden class="anchor" aria-hidden="true" href="#real-world-example-the-twitter-hack-of-2020">#</a></h4>
<p>In July 2020, a coordinated ATO attack compromised high-profile Twitter accounts, including those of Barack Obama, Joe Biden, and Elon Musk. Attackers gained access to Twitter‚Äôs internal tools by exploiting compromised employee credentials, which were likely obtained through a phishing campaign. Once inside, they used these tools to take over high-value user accounts and post fraudulent Bitcoin scams. The incident underscored the importance of securing both user and administrative accounts.</p>
<hr>
<h3 id="the-evolution-of-ato-attacks"><strong>The Evolution of ATO Attacks</strong><a hidden class="anchor" aria-hidden="true" href="#the-evolution-of-ato-attacks">#</a></h3>
<p>ATO attacks are not a new phenomenon, but their sophistication and scale have increased significantly in recent years. Attackers now use advanced techniques, such as:</p>
<ul>
<li><strong>AI-Powered Credential Stuffing</strong>: Machine learning algorithms can optimize credential stuffing attacks by identifying patterns in successful logins.</li>
<li><strong>Multi-Vector Attacks</strong>: Combining ATOs with other attack vectors, such as phishing or social engineering, to increase success rates.</li>
<li><strong>Monetization-as-a-Service</strong>: Cybercriminals can now rent ATO tools and services on darknet marketplaces, lowering the barrier to entry for would-be attackers.</li>
</ul>
<h4 id="diagram-the-modern-ato-attack-chain"><strong>Diagram: The Modern ATO Attack Chain</strong><a hidden class="anchor" aria-hidden="true" href="#diagram-the-modern-ato-attack-chain">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>[Stolen Credentials] ‚Üí [Automated Credential Stuffing] ‚Üí [Account Compromise] ‚Üí [Monetization]
</span></span></code></pre></div><hr>
<h3 id="mitigating-account-takeover-attacks"><strong>Mitigating Account Takeover Attacks</strong><a hidden class="anchor" aria-hidden="true" href="#mitigating-account-takeover-attacks">#</a></h3>
<p>Organizations and individuals must adopt a proactive approach to combat ATO attacks. Here are some key strategies:</p>
<h4 id="1-enforce-strong-password-policies"><strong>1. Enforce Strong Password Policies</strong><a hidden class="anchor" aria-hidden="true" href="#1-enforce-strong-password-policies">#</a></h4>
<ul>
<li>Require users to create complex, unique passwords.</li>
<li>Ban the reuse of previously breached passwords.</li>
<li>Implement password managers to help users generate and store secure passwords.</li>
</ul>
<h4 id="2-implement-multi-factor-authentication-mfa"><strong>2. Implement Multi-Factor Authentication (MFA)</strong><a hidden class="anchor" aria-hidden="true" href="#2-implement-multi-factor-authentication-mfa">#</a></h4>
<p>MFA adds an extra layer of security by requiring users to provide two or more forms of verification (e.g., a password and a one-time code). Even if an attacker obtains a user‚Äôs password, they cannot access the account without the second factor.</p>
<h4 id="3-monitor-for-anomalous-activity"><strong>3. Monitor for Anomalous Activity</strong><a hidden class="anchor" aria-hidden="true" href="#3-monitor-for-anomalous-activity">#</a></h4>
<p>Use advanced analytics and AI-driven security tools to detect suspicious login attempts or behavioral anomalies that may indicate an ATO.</p>
<h4 id="4-educate-users"><strong>4. Educate Users</strong><a hidden class="anchor" aria-hidden="true" href="#4-educate-users">#</a></h4>
<p>Raise awareness about the risks of password reuse and the importance of securing accounts with MFA. Provide users with resources to check if their credentials have been compromised (e.g., haveibeenpwned.com).</p>
<h4 id="5-secure-apis-and-internal-tools"><strong>5. Secure APIs and Internal Tools</strong><a hidden class="anchor" aria-hidden="true" href="#5-secure-apis-and-internal-tools">#</a></h4>
<p>As seen in the Twitter hack, attackers often target internal tools and APIs to gain access to user accounts. Ensure that these systems are secured with robust authentication and authorization mechanisms.</p>
<hr>
<h3 id="code-example-implementing-password-hashing-and-mfa"><strong>Code Example: Implementing Password Hashing and MFA</strong><a hidden class="anchor" aria-hidden="true" href="#code-example-implementing-password-hashing-and-mfa">#</a></h3>
<p>Here‚Äôs a simple example of how to implement password hashing and MFA in a web application:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Password Hashing</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> passlib.context <span style="color:#f92672">import</span> CryptContext
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pwd_context <span style="color:#f92672">=</span> CryptContext(schemes<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#34;bcrypt&#34;</span>], deprecated<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;auto&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">hash_password</span>(password: str) <span style="color:#f92672">-&gt;</span> str:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> pwd_context<span style="color:#f92672">.</span>hash(password)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">verify_password</span>(plain_password: str, hashed_password: str) <span style="color:#f92672">-&gt;</span> bool:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> pwd_context<span style="color:#f92672">.</span>verify(plain_password, hashed_password)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># MFA Implementation (Simplified)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> pyotp
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">generate_otp_secret</span>() <span style="color:#f92672">-&gt;</span> str:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> pyotp<span style="color:#f92672">.</span>random_base32()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">verify_otp</span>(token: str, secret: str) <span style="color:#f92672">-&gt;</span> bool:
</span></span><span style="display:flex;"><span>    totp <span style="color:#f92672">=</span> pyotp<span style="color:#f92672">.</span>TOTP(secret)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> totp<span style="color:#f92672">.</span>verify(token)
</span></span></code></pre></div><hr>
<h3 id="conclusion"><strong>Conclusion</strong><a hidden class="anchor" aria-hidden="true" href="#conclusion">#</a></h3>
<p>Breached passwords are a ticking time bomb, and ATO attacks are the inevitable explosion. Organizations must prioritize password security, implement MFA, and adopt proactive monitoring to stay ahead of cybercriminals. By taking these steps, we can reduce the risk of ATO attacks and protect user accounts from falling into the wrong hands.</p>
<h4 id="extended-questions-for-readers"><strong>Extended Questions for Readers</strong><a hidden class="anchor" aria-hidden="true" href="#extended-questions-for-readers">#</a></h4>
<ol>
<li>How does your organization handle password security and MFA implementation?</li>
<li>Have you ever experienced an ATO attack? What steps did you take to recover?</li>
<li>How can businesses better educate users about the risks of password reuse?</li>
</ol>
<p>Let me know your thoughts in the comments below! üõ°Ô∏è</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://www.iamdevbox.com/tags/account-takeover-ato/">Account Takeover (ATO</a></li>
      <li><a href="https://www.iamdevbox.com/tags/password-security/">Password Security</a></li>
      <li><a href="https://www.iamdevbox.com/tags/cybersecurity/">Cybersecurity</a></li>
      <li><a href="https://www.iamdevbox.com/tags/breached-passwords/">Breached Passwords</a></li>
      <li><a href="https://www.iamdevbox.com/tags/authentication/">Authentication</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://www.iamdevbox.com/posts/modern_identity_and_access_management_strategies_challenges_and_the_road_ahead/">
    <span class="title">¬´ Prev</span>
    <br>
    <span>Modern Identity and Access Management: Strategies, Challenges, and the Road Ahead</span>
  </a>
  <a class="next" href="https://www.iamdevbox.com/posts/how-to-secure-ldif-parsing-and-mapping-in-production-environments/">
    <span class="title">Next ¬ª</span>
    <br>
    <span>How to Secure LDIF Parsing and Mapping in Production Environments</span>
  </a>
</nav>

  </footer>

  
  

  
  <section class="post-related-articles custom-section">
    <h2 class="custom-section-title">
      Related Articles
    </h2>
    
    
    <ul class="custom-list">
      
      
        
          <li class="custom-list-item">
            <a href="/posts/what-is-a-jwt-and-how-does-it-work-a-developer-friendly-introduction/" class="custom-link">
              What Is a JWT and How Does It Work? A Developer-Friendly Introduction
            </a>
            <small class="custom-date">2025-08-26</small>
          </li>
          
        
      
        
          <li class="custom-list-item">
            <a href="/posts/build-your-own-jwt-decode-online-tool-with-firebase-functions-and-react/" class="custom-link">
              Build Your Own JWT Decode Online Tool with Firebase Functions and React
            </a>
            <small class="custom-date">2025-08-25</small>
          </li>
          
        
      
        
          <li class="custom-list-item">
            <a href="/posts/common-jwt-pitfalls-in-react-native-and-how-to-avoid-them/" class="custom-link">
              Common JWT Pitfalls in React Native and How to Avoid Them
            </a>
            <small class="custom-date">2025-08-05</small>
          </li>
          
        
      
        
          <li class="custom-list-item">
            <a href="/posts/best-practices-for-safely-using-jwt-decode-in-react-projects/" class="custom-link">
              Best Practices for Safely Using jwt-decode in React Projects
            </a>
            <small class="custom-date">2025-07-31</small>
          </li>
          
        
      
        
          <li class="custom-list-item">
            <a href="/posts/jwt-decoding-and-validation-how-to-securely-parse-and-verify-your-tokens/" class="custom-link">
              JWT Decoding and Validation: How to Securely Parse and Verify Your Tokens
            </a>
            <small class="custom-date">2025-06-19</small>
          </li>
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      

      
    </ul>

    
      <div class="custom-more">
        <a href="/posts/" class="custom-link">
          More &raquo;
        </a>
      </div>
    
  </section>
  

  <section class="post-recent-articles custom-section-alt">
    <h2 class="custom-section-title">
      Latest Articles
    </h2>
    
    
    
    <ul class="custom-list">
      
      
        
          
            <li class="custom-list-item">
              <a href="/posts/is-jwt-decoding-safe-on-the-frontend-security-risks-you-should-know/" class="custom-link">
                Is JWT Decoding Safe on the Frontend? Security Risks You Should Know
              </a>
              <small class="custom-date">2025-08-28</small>
            </li>
            
          
        
      
        
          
            <li class="custom-list-item">
              <a href="/posts/what-is-a-jwt-and-how-does-it-work-a-developer-friendly-introduction/" class="custom-link">
                What Is a JWT and How Does It Work? A Developer-Friendly Introduction
              </a>
              <small class="custom-date">2025-08-26</small>
            </li>
            
          
        
      
        
          
            <li class="custom-list-item">
              <a href="/posts/build-your-own-jwt-decode-online-tool-with-firebase-functions-and-react/" class="custom-link">
                Build Your Own JWT Decode Online Tool with Firebase Functions and React
              </a>
              <small class="custom-date">2025-08-25</small>
            </li>
            
          
        
      
        
          
            <li class="custom-list-item">
              <a href="/posts/comparing-the-top-jwt-decode-tools-online-services-vs-local-libraries/" class="custom-link">
                Comparing the Top JWT Decode Tools: Online Services vs Local Libraries
              </a>
              <small class="custom-date">2025-08-14</small>
            </li>
            
          
        
      
        
          
            <li class="custom-list-item">
              <a href="/posts/how-online-jwt-decode-tools-work-build-one-yourself-step-by-step/" class="custom-link">
                How Online JWT Decode Tools Work: Build One Yourself Step-by-Step
              </a>
              <small class="custom-date">2025-08-07</small>
            </li>
            
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
    </ul>

    
      <div class="custom-more">
        <a href="/posts/" class="custom-link">
          More &raquo;
        </a>
      </div>
    
  </section>
</article>
    </main>
    
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://www.iamdevbox.com/">IAMDevBox</a></span> ¬∑ 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        window.requestAnimationFrame(() => {
            const savedScroll = localStorage.getItem("menu-scroll-position");
            if (savedScroll !== null) {
            menu.scrollLeft = savedScroll;
            }
        });

        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        };
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
